Original: https://gist.github.com/CMCDragonkai/bf8e8b7553c48e4f65124bc6f41769eb

I only added the while loop because otherwise it did not work for my system
