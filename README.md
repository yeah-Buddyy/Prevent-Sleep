Original: https://gist.github.com/CMCDragonkai/bf8e8b7553c48e4f65124bc6f41769eb

Minor changes compared to the original
